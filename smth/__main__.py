import re
from os import getenv

from dotenv import load_dotenv
from telethon import TelegramClient, events
from telethon.tl.functions.messages import SendReactionRequest
from telethon.types import PeerChannel, ReactionEmoji

load_dotenv()

api_id = getenv("api_id")
api_hash = getenv("api_hash")
client = TelegramClient("my_account", api_id, api_hash)
client.flood_sleep_threshold = 300

mihail = 1546741872
budda = 5786492862

# Replace offensive words with an empty string
offensive_words = {
    r"\bÐ±Ð»Ñ\b": "Ð±Ñ‹Ð±",
    r"\bÐ±Ð»ÑÑ‚ÑŒ\b": "Ð±Ñ‹Ð±ÑŒ",
    r"\bÐ±Ð»ÑÐ´Ñ‚ÑŒ\b": "Ð±Ñ‹Ð±Ð´ÑŒ",
    r"\bÐ±Ð»ÑÐ´ÑŒ\b": "Ð±Ñ‹Ð±",
    r"\bÑÑƒÐºÐ°\b": "ÑÑƒÑ",
    r"\bÐµÐ±Ð°Ð»\b": "Ð¼Ð°Ð½ÑƒÐ»",
    r"\bÐµÐ±Ð°Ð½ÑƒÐ»ÑÑ\b": "Ð¼Ð°Ð½ÑƒÐ»ÑÑ",
    r"\bÐµÐ±Ð°Ð»ÑÑ\b": "Ð¼Ð°Ð½ÑƒÐ»Ð°Ð»ÑÑ",
    r"\bÑ‚Ñ€Ð°Ñ…Ð°Ñ‚ÑŒ\b": "Ð¼Ð°Ð½ÑƒÐ»Ð¾Ð²Ð°Ñ‚ÑŒ",
    r"\bÐ¿Ð¸Ð·Ð´ÐµÑ†\b": "ÐºÐ¾Ð¿ÐµÑ†",
    r"\bÐºÑƒÑ€Ð²Ð°\b": "ÐºÐ¾Ñ€Ð¾Ð²Ð°",
    r"\bÐ´Ð¾Ð»Ð±Ð¾ÐµÐ±\b": "Ð¼Ð¾Ð·Ð³Ð¾ÐµÐ±",
    r"\bÐ¼ÑƒÐ´Ð°Ðº\b": "Ð¼ÑƒÐ´Ñ€ÐµÑ†",
    r"\bÑƒÐµÐ±Ð¸Ñ‰Ðµ\b": "ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ",
    r"\bÐ³Ð¾Ð²Ð½Ð¾\b": "Ð³Ñ€ÐµÑ‡ÐºÐ°",
    r"\bÐ³Ð¾Ð½Ð´Ð¾Ð½\b": "Ð³Ð¾Ð½Ñ‡Ð°Ñ€",
    r"\bÑÑ€Ð°ÐºÐ°\b": "ÑÐ¾ÑÐ¸ÑÐºÐ°",
    r"\bÑ…ÐµÑ€Ð½Ñ\b": "Ñ…Ð»ÐµÐ±",
    r"\bÐ¼Ð¾Ñ‡Ð°Ð»ÐºÐ°\b": "Ð¼Ð¾Ð»Ð¾ÐºÐ¾",
    r"\bÐ´Ñ€Ð¾Ñ‡Ð¸Ñ‚ÑŒ\b": "Ð´Ñ€Ð¾Ð·Ð´Ð¸Ñ‚ÑŒ",
    r"\bÐ·Ð°Ð»ÑƒÐ¿Ð°\b": "Ð±ÐµÐ±Ñ€Ð°",
    r"\bÐ³Ð¾Ð²Ð½ÑŽÐº\b": "Ð³Ð¾Ð½Ñ‰Ð¸Ðº",
    r"\bÑ…ÑƒÐ¹\b": "Ñ…ÑƒÑ…",
    r"\bÐ´Ñ€Ð¾Ñ‡Ð¸Ñ‚ÑŒÑÑ\b": "Ð´Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒÑÑ",
    r"\bÐµÐ±ÑƒÑ‡Ð¸Ð¹\b": "ÑƒÑ‡ÐµÐ±Ð½Ñ‹Ð¹",
    r"\bÐ³Ð°Ð½Ð´Ð¾Ð½\b": "Ð³Ð°Ð½Ð³ÑÑ‚ÐµÑ€",
    r"\bÐ¿ÐµÐ½Ð¸Ñ\b": "Ð¿ÐµÐ½ÑÐ¸Ñ",
    r"\bÑÐ¾ÑÐ¸\b": "ÑÐ¾ÑÐ¸ÑÐºÐ°",
    r"\bÑ…ÑƒÐ¹Ð½Ñ\b": "Ñ„Ð¸Ð³Ð½Ñ",
    r"\bÑ…ÑƒÐ¹Ð½ÑŽ\b": "Ñ„Ð¸Ð³Ð½ÑŽ",
    r"\bÐÐ¿ÐµÐ·Ð´Ð°Ð»\b": "Ð”Ð¸Ð»Ð¸Ñ‚Ð°Ð½Ñ‚",
    r"\bÐÐ¿ÐµÐ·Ð´Ð¾ÑˆÐµÐ½Ð½Ð°Ñ\b": "Ð£Ð´Ð¸Ð²Ð»Ñ‘Ð½Ð½Ð°Ñ",
    r"\bÐ‘Ð»ÑÐ´ÑŒ\b": "Ð”ÐµÐ²ÑƒÑˆÐºÐ° Ð»Ñ‘Ð³ÐºÐ¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ",
    r"\bÐ‘Ð»ÑÐ´ÑÑ‚Ð²Ð¾\b": "Ð‘ÐµÑÐ¿Ñ€ÐµÐ´ÐµÐ»,Ð½ÐµÑ€Ð°Ð·Ð±ÐµÑ€Ð¸Ñ…Ð°",
    r"\bÐ’Ñ‹ÐµÐ±Ð¾Ð½\b": "Ð¥Ð²Ð°ÑÑ‚Ð¾Ð²ÑÑ‚Ð²Ð¾,Ð¿Ð¾ÐºÐ°Ð·ÑƒÑ…Ð°",
    r"\bÐ’Ñ‹ÐµÐ±Ð°Ñ‚ÑŒ\b": "Ð¡Ð¾Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð¾Ð²Ð¾Ð¹ Ð°ÐºÑ‚",
    r"\bÐ’Ñ…ÑƒÑŽÐ¶Ð¸Ñ‚ÑŒ\b": "Ð’Ð¾Ñ‚ÐºÐ½ÑƒÑ‚ÑŒ",
    r"\bÐ“Ð¾Ð¼Ð¾ÑÐµÐº\b": "Ð“Ð¾Ð»ÑƒÐ±Ð¾Ð¹",
    r"\bÐ”Ð¾Ð»Ð±Ð¾Ñ‘Ð±\b": "Ð”ÑƒÑ€Ð°Ðº",
    r"\bÐ•Ð±Ð»Ð¾\b": "Ð›Ð¸Ñ†Ð¾",
    r"\bÐ•Ð±Ð»Ð¸Ñ‰Ðµ\b": "Ð¢Ð¾Ð¶Ðµ Ñ‡Ñ‚Ð¾ Ð¸ ÐµÐ±Ð»Ð¾",
    r"\bÐ•Ð±Ð°Ñ‚ÑŒ\b": "Ð¡Ð¾Ð²ÐµÑ€ÑˆÐ°Ñ‚ÑŒ Ð¿Ð¾Ð»Ð¾Ð²Ð¾Ð¹ Ð°ÐºÑ‚",
    r"\bÐ•Ð±Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐ¸Ð»Ð°\b": "ÑÐ²ÐµÑ€Ñ…ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ ÑÐ¸Ð»Ð°",
    r"\bÐ•Ð±ÑƒÐ½Ð¾Ðº\b": "Ð ÐµÐ±Ñ‘Ð½Ð¾Ðº",
    r"\bÐ•Ð±Ð»Ð°Ð½\b": "Ð”ÑƒÑ€Ð°Ðº",
    r"\bÐÐ±Ð½ÑƒÑ‚ÑŒ\b": "Ð£Ð´Ð°Ñ€Ð¸Ñ‚ÑŒ",
    r"\bÐÐ±Ð¾Ð»Ñ‹Ð·Ð½ÑƒÑ‚ÑŒ\b": "Ð¡Ñ‚ÑƒÐºÐ½ÑƒÑ‚ÑŒ",
    r"\bÐ•Ð±Ð¾Ñˆ\b": "Ð“Ñ€ÑƒÐ¿Ð¾Ð²Ð¾Ð¹ ÑÐµÐºÑ",
    r"\bÐ—Ð°ÐµÐ±Ð°Ð»\b": "ÐÐ°Ð´Ð¾ÐµÐ»,Ð´Ð¾ÑÑ‚Ð°Ð»",
    r"\bÐ—Ð°ÐµÐ±Ð°Ñ‚Ñ‹Ð¹\b": "Ð¥Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹,Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹",
    r"\bÐ—Ð»Ð°ÐµÐ±ÑƒÑ‡Ð¸Ð¹\b": "ÐÐµÑ…Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹,Ð¿Ð»Ð¾Ñ…Ð¾Ð¹",
    r"\bÐ—Ð°Ñ‘Ð±\b": "Ð—Ð°ÑÐºÐ¾Ðº,ÑÐ´Ð²Ð¸Ð³ Ð¿Ð¾ Ñ„Ð°Ð·Ðµ",
    r"\bÐ˜Ð´Ð¸ Ð½Ð° Ñ…ÑƒÐ¹\b": "ÐžÑ‚ÑÑ‚Ð°Ð½Ñ‚ÑŒ, ÑÐ²Ð¾Ð±Ð¾Ð´ÐµÐ½",
    r"\bÐšÐ¾Ð»Ð´Ð¾ÐµÐ±Ð¸Ð½Ð°\b": "Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ Ð²ÐµÑ‰ÑŒ, Ð¿Ñ€ÐµÐ¿ÑÑ‚ÑÑ‚Ð²Ð¸Ðµ",
    r"\bÐœÐ°Ð½Ð´Ð°\b": "Ð–ÐµÐ½ÑÐºÐ¸Ðµ Ð¿Ð¾Ð»Ð¾Ð²Ñ‹Ðµ Ð¾Ñ€Ð³Ð°Ð½Ñ‹",
    r"\bÐœÐ°Ð½Ð´Ð¾Ð²Ð¾ÑˆÐºÐ°\b": "ÐœÐ°Ð»Ð¾Ð»ÐµÑ‚ÐºÐ°",
    r"\bÐœÐ¾ÐºÑ€Ð¾Ñ‰ÐµÐ»ÐºÐ°\b": "Ð”ÐµÐ²ÑƒÑˆÐºÐ° Ð»ÐµÐ³ÐºÐ¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ",
    r"\bÐÐ°ÐµÐ±ÐºÐ°\b": "ÐžÐ±Ð¼Ð°Ð½",
    r"\bÐÐ°ÐµÐ±Ð°Ð»\b": "ÐžÐ±Ð¼Ð°Ð½ÑƒÐ»",
    r"\bÐÐ°ÐµÐ±Ð°Ð»Ð¾Ð²ÐºÐ°\b": "Ð¥Ð¸Ñ‚Ñ€Ð¾ÑÑ‚ÑŒ, ÑƒÐ»Ð¾Ð²ÐºÐ°",
    r"\bÐÐ°Ð¿Ð¸Ð·Ð´ÐµÑ‚ÑŒ\b": "Ð¡Ð¾Ð²Ñ€Ð°Ñ‚ÑŒ, Ð¾Ð±Ð¼Ð°Ð½ÑƒÑ‚ÑŒ",
    r"\bÐžÑ‚ÑŠÐµÐ±Ð¸ÑÑŒ\b": "ÐžÑ‚ÑÑ‚Ð°Ð½ÑŒ",
    r"\bÐžÑ…ÑƒÐµÑ‚ÑŒ\b": "Ð£Ð´Ð¸Ð²Ð¸Ñ‚ÑŒÑÑ",
    r"\bÐžÑ‚Ñ…ÑƒÐµÐ²ÐµÑ€Ñ‚Ð¸Ñ‚ÑŒ\b": "Ð˜Ð·Ð±Ð¸Ñ‚ÑŒ",
    r"\bÐžÐ¿Ð¸Ð·Ð´ÐµÐ½ÐµÑ‚ÑŒ\b": "ÐžÐ±Ð½Ð°Ð³Ð»ÐµÑ‚ÑŒ",
    r"\bÐžÑ…ÑƒÐµÐ²ÑˆÐ¸Ð¹\b": "ÐžÐ±Ð½Ð°Ð³Ð»ÐµÐ²ÑˆÐ¸Ð¹",
    r"\bÐžÑ‚ÐµÐ±ÑƒÐºÐ°Ñ‚ÑŒ\b": "ÐŸÐ¾ÐºÐ¾Ð»Ð°Ñ‚Ð¸Ñ‚ÑŒ",
    r"\bÐŸÐ¸Ð·Ð´Ð°\b": "Ð–ÐµÐ½ÑÐºÐ¸Ðµ Ð¿Ð¾Ð»Ð¾Ð²Ñ‹Ðµ Ð¾Ñ€Ð³Ð°Ð½Ñ‹",
    r"\bÐŸÐ¸Ð´Ð°Ñ€Ð°Ñ\b": "Ð“Ð¾Ð»ÑƒÐ±Ð¾Ð¹",
    r"\bÐŸÐ¸Ð·Ð´Ð°Ñ‚Ñ‹Ð¹\b": "Ð¥Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹",
    r"\bÐŸÐ¸Ð·Ð´ÐµÑ†\b": "ÐšÐ¾Ð½ÐµÑ†, ÑÐ¼ÐµÑ€Ñ‚ÑŒ",
    r"\bÐŸÐ¸Ð·Ð´Ð°Ð½ÑƒÑ‚Ñ‹Ð¹\b": "Ð”ÑƒÑ€Ð½Ð¾Ð¹",
    r"\bÐŸÐ¾ÐµÐ±Ð°Ñ‚ÑŒ\b": "ÐÐ°Ð¿Ð»ÐµÐ²Ð°Ñ‚ÑŒ",
    r"\bÐŸÐ¾ÐµÐ±ÑƒÑÑ‚Ð¸ÐºÐ°\b": "Ð ÑƒÑ‚Ð¸Ð½Ð°",
    r"\bÐŸÑ€Ð¾ÐµÐ±Ð°Ñ‚ÑŒ\b": "ÐŸÐ¾Ñ‚ÐµÑ€ÑÑ‚ÑŒ",
    r"\bÐŸÐ¾Ð´Ð·Ð°Ð»ÑƒÐ¿Ð½Ñ‹Ð¹\b": "ÐžÐ¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ð¹",
    r"\bÐŸÐ¸Ð·Ð´ÐµÐ½Ñ‹Ñˆ\b": "ÐÐµÐ·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº",
    r"\bÐŸÑ€Ð¸Ð¿Ð¸Ð·Ð´Ð°Ðº\b": "Ð”ÑƒÑ€Ð°Ð»ÐµÐ¹",
    r"\bÐ Ð°Ð·ÑŠÐµÐ±Ð°Ñ‚ÑŒ\b": "Ð Ð°Ð·Ð±Ð¸Ñ‚ÑŒ",
    r"\bÐ Ð°ÑÐ¿Ð¸Ð·Ð´ÑÐ¹\b": "Ð Ð°Ð·Ð²ÑÐ·Ð°Ð½Ð½Ñ‹Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº, Ð´ÐµÐ»Ð°ÑŽÑ‰Ð¸Ð¹ Ð²ÑÐµ ÑÐ¿ÑƒÑÑ‚Ñ Ñ€ÑƒÐºÐ°Ð²Ð°",
    r"\bÐ Ð°Ð·ÑŠÐµÐ±Ð°Ð½Ð½Ñ‹Ð¹\b": "Ð Ð°Ð·Ð±Ð¸Ñ‚Ñ‹Ð¹",
    r"\bÐ¡ÑƒÐºÐ°\b": "ÐÐµÑ…Ð¾Ñ€Ð¾ÑˆÐ°Ñ Ð¶ÐµÐ½Ñ‰Ð¸Ð½Ð°",
    r"\bÐ¡ÑƒÑ‡ÐºÐ°\b": "Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾-Ð»Ð°ÑÐºÐ°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ñ‚ 'ÑÑƒÐºÐ¸'",
    r"\bÐ¢Ñ€Ð°Ñ…Ð°Ñ‚ÑŒ\b": "Ð¡Ð¾Ð²ÐµÑ€ÑˆÐ°Ñ‚ÑŒ Ð¿Ð¾Ð»Ð¾Ð²Ð¾Ð¹ Ð°ÐºÑ‚",
    r"\bÐ£ÐµÐ±Ð¾Ðº\b": "ÐžÑ‚Ð¼Ð¾Ñ€Ð¾Ð·Ð¾Ðº",
    r"\bÐ£ÐµÐ±Ð°Ñ‚ÑŒ\b": "Ð£Ð´Ð°Ñ€Ð¸Ñ‚ÑŒ",
    r"\bÐ£Ð³Ð¾Ð½Ð´Ð¾ÑˆÐ¸Ñ‚ÑŒ\b": "Ð˜Ð·Ð±Ð¸Ñ‚ÑŒ, ÑƒÐ±Ð¸Ñ‚ÑŒ, ÑƒÐ½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ",
    r"\bÐ£ÐµÐ±Ð°Ð½\b": "Ð¢Ð¾ Ð¶Ðµ Ñ‡Ñ‚Ð¾ Ð¸ 'ÑƒÐµÐ±Ð¾Ðº'",
    r"\bÐ¥Ð¸Ñ‚Ñ€Ð¾Ð²Ñ‹ÐµÐ±Ð°Ð½Ð½Ñ‹Ð¹\b": "Ð¡ÐºÐ¾Ð»ÑŒÐ·ÐºÐ¸Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº",
    r"\bÐ¥ÑƒÐ¹\b": "ÐœÑƒÐ¶ÑÐºÐ¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¾Ð¹ Ð¾Ñ€Ð³Ð°Ð½, Ð»Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð¼ÑƒÐ¶ÑÐºÐ¾Ð³Ð¾ Ð¿Ð¾Ð»Ð°",
    r"\bÐ¥ÑƒÐ¹Ð½Ñ\b": "ÐÐµÐºÐ¸Ð¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚, Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ð»Ð¾Ñ…Ð¾Ðµ",
    r"\bÐ¥ÑƒÐµÑ‚Ð°\b": "Ð—Ð°Ð¼Ð¾Ñ€Ð¾Ñ‡ÐºÐ°",
    r"\bÐ¥ÑƒÐµÐ²Ð¾\b": "ÐŸÐ»Ð¾Ñ…Ð¾",
    r"\bÐ¥ÑƒÐµÑÐ¾Ñ\b": "Ð¡Ð¾ÑÑƒÑ‰Ð¸Ð¹ Ð¼ÑƒÐ¶ÑÐºÐ¾Ð¹ Ñ‡Ð»ÐµÐ½",
    r"\bÐ¥ÑƒÐµÑ‚ÑŒ\b": "ÑƒÐ´Ð¸Ð²Ð»ÑÑ‚ÑŒÑÑ, Ð±Ð°Ð»Ð´ÐµÑ‚ÑŒ",
    r"\bÐ¥ÑƒÐµÐ²ÐµÑ€Ñ‚Ð¸Ñ‚ÑŒ\b": "Ð‘Ð¸Ñ‚ÑŒ, Ð¸Ð·Ð±Ð¸Ð²Ð°Ñ‚ÑŒ",
    r"\bÐ¥ÑƒÐµÐ³Ð»Ð¾Ñ‚\b": "Ð“Ð»Ð¾Ñ‚Ð°ÑŽÑ‰Ð¸Ð¹ Ð¼ÑƒÐ¶ÑÐºÐ¾Ð¹ Ñ‡Ð»ÐµÐ½",
    r"\bÐ¥ÑƒÐ¸ÑÑ‚Ð¸ÐºÐ°\b": "ÐÐ°ÑƒÐºÐ° Ð¿Ñ€Ð¾....",
    r"\bÐ§Ð»ÐµÐ½Ð¾ÑÐ¾Ñ\b": "Ð¢Ð¾ Ð¶Ðµ Ñ‡Ñ‚Ð¾ Ð¸ 'Ñ…ÑƒÐµÑÐ¾Ñ'",
    r"\bÐ§Ð»ÐµÐ½Ð¾Ð¿Ð»ÐµÑ‚\b": "Ð‘Ð°Ð»Ð±ÐµÑ",
    r"\bÐ¨Ð»ÑŽÑ…Ð°\b": "ÐŸÑ€Ð¾ÑÑ‚Ð¸Ñ‚ÑƒÑ‚ÐºÐ°",
}


def filter_russian_offensive(text: str):
    # Use regular expressions to match complete words
    for word, replaces in offensive_words.items():
        text = re.sub(word, replaces, text, flags=re.IGNORECASE)

    return text


@client.on(events.NewMessage)
async def handle_message(event: events.NewMessage.Event):
    # Check if the message is from a user
    if event.sender_id == 876980354:
        # Filter the message text
        filtered_text = filter_russian_offensive(event.raw_text)

        # Send the filtered text back to the user
        if not filtered_text == event.raw_text:
            await event.edit(filtered_text)


async def spam_reaction():
    i = 0
    valid_messages_ids = []
    channel = PeerChannel(channel_id=1759079503)
    async for message in client.iter_messages(channel, from_user=budda):
        if message.reactions is not None and "ðŸ¤”" in [
            result.reaction.emoticon for result in message.reactions.results
        ]:
            print("skipping")
            continue

        valid_messages_ids.append(message.id)
        if len(valid_messages_ids) > 100:
            break

    print(valid_messages_ids)

    for message_id in valid_messages_ids:
        i += 1
        await client(
            SendReactionRequest(
                peer=channel,
                msg_id=message_id,
                reaction=[ReactionEmoji(emoticon="ðŸ¤”")],
            )
        )
        print(f"{i} ðŸ¤”")


with client:
    client.run_until_disconnected()
